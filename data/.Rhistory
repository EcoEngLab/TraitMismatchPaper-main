legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
rm(list=ls())
graphics.off()
require('tidyverse')
require('cowplot')
require('patchwork')
require('ggtext')
# Plot mass corrected value of $r_m$ at Topt against the peak temperature for $r_m$
rm_data <- as_tibble(read_csv('../results/r_mCalcs.csv')) %>%
group_by(species) %>% slice(which.max(rm_opt)) %>%
arrange(curve_ID) %>% mutate(curve_ID = as.character(curve_ID))
str(rm_data)
rm_data %>% print(n=16)
spps <- "case_when(species == 'Anoplophora glabripennis' ~ '1',
species == 'Halyomorpha halys' ~ '2',
species == 'Aedes aegypti' ~ '3',
species == 'Anthonomus grandis' ~ '4',
species == 'Paracoccus marginatus' ~ '5',
species == 'Acyrthosiphon pisum' ~ '6',
species == 'Aphis gossypii' ~ '7',
species == 'Bemisia tabaci' ~ '8',
species == 'Tetraneura nigriabdominalis' ~ '9',
species == 'Stethorus punctillum' ~ '10',
species == 'Tetranychus mcdanieli' ~ '11',
species == 'Muscidifurax zaraptor' ~ '12',
species == 'Aphis nasturtii' ~ '13',
species == 'Rhopalosiphum maidis' ~ '14',
species == 'Thrips hawaiiensis' ~ '15',
species == 'Helicoverpa armigera' ~ '16')"
bodyMass <- as_tibble(read.csv("../data/sizeMeans.csv")) %>%
rename(species = interactor1, mass = avg, mass_sd = sd) %>%
mutate(curve_ID = eval(parse(text=spps))) %>%
filter(curve_ID != 'NA') %>% arrange(curve_ID)
head(bodyMass)
str(bodyMass)
bodyMass <- bodyMass %>% select(mass, curve_ID)
head(bodyMass)
rm_data <- rm_data %>% inner_join(bodyMass)
head(rm_data)
rm_data$kT <- 1/(8.617333262145 * 10^-5 * (rm_data$temp+273.15))
#plot uncorrected data in log-log scale
rm_data %>%
ggplot(aes(x=log(mass), y = log(rm_opt)))+
geom_point()+
geom_smooth(method = 'lm')
#plot rm_opt vs T
rm_data %>%
ggplot(aes(x = temp, y = rm_opt)) +
geom_point()+
geom_smooth(method = 'lm')
# linear model (note the allometry is linear in log-log scale)
rm_model <- lm(log(rm_opt) ~ log(mass) + kT, data = rm_data)
summary(rm_model)
coef(rm_model)
save(rm_model,file= "../results/rm_MTE_model.Rdata")
cf <-  confint(rm_model,level = .95)
anova(rm_model)
head(rm_data)
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-4.5,-0.5),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(23.9,33),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-4.5,-0.5),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(23.9,33),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-4.5,1),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(23.9,33),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-5,1),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(23.9,33),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-5,1),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(20,33),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-5,1),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(20,38),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
rm_data <- as_tibble(read_csv('../results/r_mCalcs.csv')) %>%
group_by(species) %>% slice(which.max(rm_opt)) %>%
arrange(curve_ID) %>% mutate(curve_ID = as.character(curve_ID))
str(rm_data)
View(rm_data)
exp(-1)
#plot rm_opt in 1/kT, correcting for mass
MassCorr_rm_opt <-
rm_data %>%
ggplot(aes(x = temp, y = log(rm_opt/mass^coef(rm_model)[2]))) +
geom_smooth(method = 'lm', colour = '#636363', size=0.3, fill="gray")+
scale_y_continuous(expression(plain(paste("Log of mass-corrected ",italic(r[m]),
" at its optimal temperature (ln(",
italic(r[paste(m,",", opt)])," / ",
italic(M^-0.17),"))"))),
limits=c(-5,1),
expand = c(0.01, 0),
breaks=seq(-4,-1, by=1))+
scale_x_continuous(expression(paste(italic(T[pk]))),
limits=c(20,38),
expand = c(0, 0),
breaks=seq(20,34, by=2))+
geom_point(aes(shape = species, fill = species), size=2,stroke=0.25)+
scale_shape_manual(values = c(21,21,21,21,
22,22,22,22,
23,23,23,23,
24,24,24,24),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_fill_manual(values = c("#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333",
"#EEEEEE","#CCCCCC","#999999","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
scale_colour_manual(values = c("#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333",
"#333333","#333333","#333333","#333333"),
name=expression(bold("")),
guide = guide_legend(nrow=8,ncol=2,
direction = "vertical",
title.position = "top",
title.hjust=0.5))+
theme_bw()+
#theme(text=element_text(family="Times"))+
theme(text = element_text(size=11),
legend.position = 'none',
legend.text = element_text(size = 4.5, face = 'italic'),
legend.background = element_rect(colour = "black", size = 0.125),
legend.margin=margin(t = 0.1, b = 0.1, r=0.1,l=0.1, unit='cm'),
legend.key.size = unit(0.2, 'cm'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(x = -Inf, y = Inf,hjust = -0.5,vjust=1.4,
label = "B"),size = 5, colour = "black")+
theme(axis.title.y = element_text(size = 9))
MassCorr_rm_opt
rm_data <- as_tibble(read_csv('../results/r_mCalcs.csv')) %>%
group_by(species) %>% slice(which.max(rm_opt)) %>%
arrange(curve_ID) %>% mutate(curve_ID = as.character(curve_ID))
str(rm_data)
rm_data %>% print(n=16)
bodyMass <- as_tibble(read.csv("../data/sizeMeans.csv"))
View(bodyMass)
spps <- "case_when(species == 'Anoplophora glabripennis' ~ '1',
species == 'Halyomorpha halys' ~ '2',
species == 'Aedes aegypti' ~ '3',
species == 'Anthonomus grandis' ~ '4',
species == 'Paracoccus marginatus' ~ '5',
species == 'Acyrthosiphon pisum' ~ '6',
species == 'Aphis gossypii' ~ '7',
species == 'Bemisia tabaci' ~ '8',
species == 'Tetraneura nigriabdominalis' ~ '9',
species == 'Stethorus punctillum' ~ '10',
species == 'Tetranychus mcdanieli' ~ '11',
species == 'Muscidifurax zaraptor' ~ '12',
species == 'Aphis nasturtii' ~ '13',
species == 'Rhopalosiphum maidis' ~ '14',
species == 'Thrips hawaiiensis' ~ '15',
species == 'Helicoverpa armigera' ~ '16')"
bodyMass <- as_tibble(read.csv("../data/sizeMeans.csv")) %>%
rename(species = interactor1, mass = avg, mass_sd = sd) %>%
mutate(curve_ID = eval(parse(text=spps))) %>%
filter(curve_ID != 'NA') %>% arrange(curve_ID)
View(bodyMass)
rm_data <- as_tibble(read_csv('../results/r_mCalcs.csv')) %>%
group_by(species) %>% slice(which.max(rm_opt)) %>%
arrange(curve_ID) %>% mutate(curve_ID = as.character(curve_ID))
str(rm_data)
View(rm_data)
exp(-4)
